
clear
$SystemProcess = Get-WmiObject Win32_Process | Where-Object {$_.processname -eq "system"}
    if ($SystemProcess.ParentProcessId -eq 3)
    {   }
        elseif ($SystemProcess.ParentProcessId -ne 1)
            {Write-Host "Protential threat found with process: " -ForegroundColor DarkYellow -NoNewline
             Write-Host "System" -ForegroundColor DarkYellow "`n"
             Write-Host "     - System should have no ParentProcessID"
             $SystemProcess | select ProcessID, ParentProcessID | FT -AutoSize
            }


$parentprocesspid= $SystemProcess.ParentProcessId
$parentprocessname= $(get-process -id $parentprocesspid).name

write-host "$parentprocesspid -- $parentprocessname"
